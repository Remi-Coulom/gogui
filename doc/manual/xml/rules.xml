<chapter id="rules">
<title>Rules</title>

<para>
A GTP program is able to change the GoGui game into similar games as Go
(Gomoku, Renju, Othello...). It only supports two-players games.
</para>

<para>Ruler programs can be attached from the menu <guimenuitem>Game
</guimenuitem> > <guisubmenu>Rules</guisubmenu>. A ruler program can
not generate moves, contrary to the programs attached from the <guimenuitem>
Program</guimenuitem> menu.
</para>

<para>
The game results are shown at the end of the game in a dialog box. Resizing the
board is not possible while another game is currently attached.
</para>

<para>
It is compulsory that the ruler program implements the extension command
<userinput>gogui-analyze_commands</userinput>, which allows GoGui to query which
analyze commands are supported when a new program is attached.
</para>

<section>
<title>Menubar</title>
<variablelist>

<varlistentry>
<term><guisubmenu>Attach</guisubmenu></term>
<listitem>
<para>
Start a program from the list of ruler programs and synchronize it to the
current game at the current position.
If a ruler was already attached, it will be terminated, before the new
ruler is started.
If the ruler is another game than its predecessor, the position is cleared
from the ruler's initial position (called by
<userinput>gogui-rules_board</userinput>).
</para>
</listitem>
</varlistentry>

<varlistentry>
<term><guisubmenu>Detach</guisubmenu></term>
<listitem>
<para>
Terminate the currently attached ruler program.
</para>
</listitem>
</varlistentry>

<varlistentry>
<term><guisubmenu>New Program</guisubmenu></term>
<listitem>
<para>
Add a new Go program to the list of available Go programs.
The name field should contain a label for the
<guisubmenu>Attach</guisubmenu> menu.
The command field should contain the command to run the Go program.
</para>
</listitem>
</varlistentry>

<varlistentry>
<term><guisubmenu>Edit Programs</guisubmenu></term>
<listitem>
<para>
Edit the list of available Go programs.
</para>
</listitem>
</varlistentry>


</variablelist>
</section>

<section>
<title>Requirements</title>
<para>
To work with this version of GoGui, it is required that the GTP program
possesses the following methods (of the format
<command>gogui-rules_[command_name]</command>) :
</para>

<variablelist>

<varlistentry>
<term><command>gogui-rules_game_id</command></term>
<listitem>
<simpara>
The response of the command is a string that specifies the game that is managed
by the GTP program. It must begin with an uppurcase letter and then contain
only lowercase characters.
Example :<programlisting>
gogui-rules_game_id
    = Othello
</programlisting>
</simpara>
</listitem>
</varlistentry>

<varlistentry>
<term><command>gogui-rules_board</command></term>
<listitem>
<simpara>
The response of the command is a board of string containing '.' for an empty
intersection of the Goban, 'X' for a black stone or 'O' for a white stone.
Other characters are ignored.
This command will be used to display the board in GoGui.
Example :<programlisting>
gogui-rules_board
    = . . . . . . . . .
      . . X . O . X . .
      . X . . . . . . .
      . . O . . . . O .
      . . . . . . . O .
      . O . X . . O X .
      . . O X . . . X .
      . X O . . X O X .
      . . . . . O . . .
</programlisting>
</simpara>
</listitem>
</varlistentry>

<varlistentry>
<term><command>gogui-rules_board_size</command></term>
<listitem>
<simpara>
The response of the command is a string containing an integer that specifies
the board size of the game. The board in GoGui will always be non-resizable
when a ruler program is attached.
Example :<programlisting>
gogui-rules_board_size
    = 15
</programlisting>
</simpara>
</listitem>
</varlistentry>

<varlistentry>
<term><command>gogui-rules_legal_moves</command></term>
<listitem>
<simpara>
Possible move list command for the current side to move.
The command is used to determine the moves that the player will be able to play
(otherwise, an illegal move message will be sent).
The command result must necessarily be a string of the following syntax :
"A1 B9 C5 C6 pass".
The character 'I' must not be used. The 8th letter is 'H' and the 9th letter is
'J' like in the Go standards. The figures start with 1 instead of 0.
Pass must appear in the response to this command if the player is allowed
to pass.
If no move is possible, the game ends.
Example :<programlisting>
gogui-rules_legal_moves
    = A1 A2 A3 A5 A6 A7 A9 B1 B2 B4 B5 B6
      B8 C1 C2 C6 C7 C8 D2 D4 D5 D7 D8 E1
      E2 E4 E6 E7 F6 F8 F9 G2 G3 G5 G6 G7
      G8 H1 H5 H6 H9 J1 J3 J4 J5 J7 J8 pass
</programlisting>
</simpara>
</listitem>
</varlistentry>

<varlistentry>
<term><command>gogui-rules_side_to_move</command></term>
<listitem>
<simpara>
The command must return a string beginning with <userinput>'b'</userinput>,
<userinput>'w'</userinput>, <userinput>'B'</userinput> or <userinput>'W'
</userinput>.
Example :<programlisting>
gogui-rules_side_to_move
    = white
</programlisting>
</simpara>
</listitem>
</varlistentry>

<varlistentry>
<term><command>gogui-rules_final_result</command></term>
<listitem>
<simpara>
The result of this command is a string that will be shown in a dialog box once
the game finishes. This is the only way to notice about the game result when a
ruler program is attached since the <guimenuitem>Score</guimenuitem> menu is
disabled.
Example :<programlisting>
gogui-rules_final_result
    = White wins by 4 points. Final score
      is B 30 and W 34.
</programlisting>
</simpara>
</listitem>
</varlistentry>

<varlistentry>
</varlistentry>

</variablelist>
</section>

<section><title>End</title>
<para>
The game ends if the response to the command <userinput>gogui-rules_legal_moves
</userinput> is an empty string.
</para>
<para>
Then, GoGui queries the score to the ruler program with
<userinput>gogui-rules_final_result</userinput> and shows the result string
in a dialog box.
</para>
<para><!-- Empty paragraph to enforce space in JEditorPane --></para>

</section>

</chapter>
